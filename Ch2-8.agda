{-# OPTIONS --without-K #-}

module Ch2-8 where
open import Ch2-7 public

--2.8
ğŸ™â‰¡â»Â¹ : {x y : ğŸ™} â†’ (x â‰¡ y) â†’ ğŸ™
ğŸ™â‰¡â»Â¹ = (Î» _ â†’ âŠ¤)

ğŸ™â‰¡ : {x y : ğŸ™} â†’ ğŸ™ â†’ (x â‰¡ y)
ğŸ™â‰¡ {x} {y} = (Î» z â†’ indğŸ™ (Î» z â†’ (x y : ğŸ™) â†’ x â‰¡ y)
                         (Î» x y â†’ indğŸ™ (Î» x â†’ (y : ğŸ™) â†’ x â‰¡ y)
                                       (Î» y â†’ indğŸ™ (Î» y â†’ âŠ¤ â‰¡ y) (refl âŠ¤) y)
                                       x y)
                         z x y)

--Theorem 2.8.1
ğŸ™â‰ƒ : {x y : ğŸ™} â†’ (x â‰¡ y) â‰ƒ ğŸ™
ğŸ™â‰ƒ {x} {y} = ğŸ™â‰¡â»Â¹ , qinvâ†’isequiv (ğŸ™â‰¡ , ( (Î» u â†’ indğŸ™ (Î» u â†’ (ğŸ™â‰¡â»Â¹ {x = x} {y = y} âˆ˜ ğŸ™â‰¡) u â‰¡ u)
                                                    (refl âŠ¤)
                                                    u)
                                      , (Î» p â†’ indâ‰¡ (Î» x y p â†’ (ğŸ™â‰¡ âˆ˜ ğŸ™â‰¡â»Â¹) p â‰¡ p)
                                                    (indğŸ™ (Î» x â†’ (ğŸ™â‰¡ âˆ˜ ğŸ™â‰¡â»Â¹) (refl x) â‰¡ refl x)
                                                          (refl (refl âŠ¤)))
                                                    x y p)))
                                                     
uniqğŸ™ : (u : ğŸ™) â†’ u â‰¡ âŠ¤
uniqğŸ™ = indğŸ™ (Î» u â†’ u â‰¡ âŠ¤) (refl âŠ¤)
